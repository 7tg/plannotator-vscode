#!/bin/sh
# Plannotator WebView Router
# Invoked via PLANNOTATOR_BROWSER env var
# Sends URL to the extension's local IPC server

url="$1"
[ -z "$url" ] && exit 0
[ -z "$PLANNOTATOR_VSCODE_PORT" ] && exit 1

encoded=$(node -e "process.stdout.write(encodeURIComponent(process.argv[1]))" "$url")
curl -s "http://127.0.0.1:${PLANNOTATOR_VSCODE_PORT}/open?url=${encoded}" >/dev/null 2>&1
